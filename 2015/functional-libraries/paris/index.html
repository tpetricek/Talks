<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Functional library design</title>
    <meta name="description" content="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks.">
    <meta name="author" content="Tomas Petricek">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="//code.jquery.com/jquery-1.8.0.js"></script>
    <script src="//code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/night.css" id="theme">
    <link type="text/css" rel="stylesheet" href="fsharp.formatting/styles/style.css" />
    <link type="text/css" rel="stylesheet" href="fsharp.formatting/styles/deedle.css" />
    <link type="text/css" rel="stylesheet" href="css/custom.css" />
    <link rel="stylesheet" href="images/css/font-awesome.min.css">
    <script src="fsharp.formatting/styles/tips.js" type="text/javascript"></script>
    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
    </script>
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>
<body>
    <div class="reveal">
        <div class="tip" id="fs1">val collectSnips : par:&#39;a -&gt; seq&lt;&#39;b&gt;<br /><br />Full name: index.collectSnips</div>
<div class="tip" id="fs2">val par : &#39;a</div>
<div class="tip" id="fs3">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs4">val codes : seq&lt;obj&gt;<br /><br />Full name: index.codes</div>
<div class="tip" id="fs5">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs6">val collect : mapping:(&#39;T -&gt; #seq&lt;&#39;U&gt;) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.collect</div>
<div class="tip" id="fs7">val replaceSnips : lookup:&#39;a -&gt; par:&#39;b -&gt; &#39;c<br /><br />Full name: index.replaceSnips</div>
<div class="tip" id="fs8">val lookup : &#39;a</div>
<div class="tip" id="fs9">val par : &#39;b</div>
<div class="tip" id="fs10">Multiple items<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />Full name: Microsoft.FSharp.Core.LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs11">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs12">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs13">val newPars : (obj -&gt; obj) list<br /><br />Full name: index.newPars</div>
<div class="tip" id="fs14">type IDocProcessor =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;abstract member OnFormatDoc : &#39;a0 -&gt; &#39;a1<br />&#160;&#160;&#160;&#160;abstract member OnFormatSnippet : &#39;a0 -&gt; &#39;a1<br />&#160;&#160;&#160;&#160;abstract member OnParseDoc : &#39;a0 -&gt; &#39;a1<br />&#160;&#160;&#160;&#160;abstract member OnParseSnippet : &#39;a0 -&gt; &#39;a1<br />&#160;&#160;end<br /><br />Full name: index.IDocProcessor</div>
<div class="tip" id="fs15">abstract member IDocProcessor.OnParseDoc : &#39;a0 -&gt; &#39;a1<br /><br />Full name: index.IDocProcessor.OnParseDoc</div>
<div class="tip" id="fs16">abstract member IDocProcessor.OnFormatDoc : &#39;a0 -&gt; &#39;a1<br /><br />Full name: index.IDocProcessor.OnFormatDoc</div>
<div class="tip" id="fs17">abstract member IDocProcessor.OnParseSnippet : &#39;a0 -&gt; &#39;a1<br /><br />Full name: index.IDocProcessor.OnParseSnippet</div>
<div class="tip" id="fs18">abstract member IDocProcessor.OnFormatSnippet : &#39;a0 -&gt; &#39;a1<br /><br />Full name: index.IDocProcessor.OnFormatSnippet</div>
<div class="tip" id="fs19">Multiple items<br />type MultiLangHandler =<br />&#160;&#160;inherit obj<br />&#160;&#160;new : unit -&gt; MultiLangHandler<br />&#160;&#160;override OnFormatSnippet : snip:&#39;a -&gt; &#39;b<br />&#160;&#160;override OnParseSnippet : snip:&#39;a -&gt; &#39;b<br /><br />Full name: index.MultiLangHandler<br /><br />--------------------<br />new : unit -&gt; MultiLangHandler</div>
<div class="tip" id="fs20">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs21">override MultiLangHandler.OnParseSnippet : snip:&#39;a -&gt; &#39;b<br /><br />Full name: index.MultiLangHandler.OnParseSnippet</div>
<div class="tip" id="fs22">override MultiLangHandler.OnFormatSnippet : snip:&#39;a -&gt; &#39;b<br /><br />Full name: index.MultiLangHandler.OnFormatSnippet</div>
<div class="tip" id="fs23">val doc : obj<br /><br />Full name: index.doc</div>
<div class="tip" id="fs24">val snips : obj<br /><br />Full name: index.snips</div>
<div class="tip" id="fs25">type Game =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;abstract member Draw : DrawingContext -&gt; unit<br />&#160;&#160;&#160;&#160;abstract member Initialize : unit -&gt; unit<br />&#160;&#160;&#160;&#160;abstract member Update : unit -&gt; unit<br />&#160;&#160;end<br /><br />Full name: index.Game</div>
<div class="tip" id="fs26">abstract member Game.Initialize : unit -&gt; unit<br /><br />Full name: index.Game.Initialize</div>
<div class="tip" id="fs27">type unit = Unit<br /><br />Full name: Microsoft.FSharp.Core.unit</div>
<div class="tip" id="fs28">abstract member Game.Draw : DrawingContext -&gt; unit<br /><br />Full name: index.Game.Draw</div>
<div class="tip" id="fs29">type DrawingContext = | DC<br /><br />Full name: index.DrawingContext</div>
<div class="tip" id="fs30">abstract member Game.Update : unit -&gt; unit<br /><br />Full name: index.Game.Update</div>
<div class="tip" id="fs31">Multiple items<br />type MyGame =<br />&#160;&#160;inherit Game<br />&#160;&#160;new : unit -&gt; MyGame<br />&#160;&#160;override Draw : ctx:DrawingContext -&gt; unit<br />&#160;&#160;override Initialize : unit -&gt; unit<br />&#160;&#160;override Update : unit -&gt; unit<br /><br />Full name: index.MyGame<br /><br />--------------------<br />new : unit -&gt; MyGame</div>
<div class="tip" id="fs32">override MyGame.Initialize : unit -&gt; unit<br /><br />Full name: index.MyGame.Initialize</div>
<div class="tip" id="fs33">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs34">override MyGame.Update : unit -&gt; unit<br /><br />Full name: index.MyGame.Update</div>
<div class="tip" id="fs35">override MyGame.Draw : ctx:DrawingContext -&gt; unit<br /><br />Full name: index.MyGame.Draw</div>
<div class="tip" id="fs36">module Option<br /><br />from Microsoft.FSharp.Core</div>
<div class="tip" id="fs37">val iter : action:(&#39;T -&gt; unit) -&gt; option:&#39;T option -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Option.iter</div>
<div class="tip" id="fs38">type IEvent&lt;&#39;T&gt; = IEvent&lt;Handler&lt;&#39;T&gt;,&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.IEvent&lt;_&gt;</div>
<div class="tip" id="fs39">type bool = System.Boolean<br /><br />Full name: Microsoft.FSharp.Core.bool</div>
<div class="tip" id="fs40">val game : Game<br /><br />Full name: index.game</div>
<div class="tip" id="fs41">val mario : obj<br /><br />Full name: index.mario</div>
<div class="tip" id="fs42">val loop : x:&#39;a -&gt; Async&lt;unit&gt;<br /><br />Full name: index.loop</div>
<div class="tip" id="fs43">val x : &#39;a</div>
<div class="tip" id="fs44">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs45">Multiple items<br />type Async<br />static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member CancelDefaultToken : unit -&gt; unit<br />static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg:&#39;Arg1 * beginAction:(&#39;Arg1 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * beginAction:(&#39;Arg1 * &#39;Arg2 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * arg3:&#39;Arg3 * beginAction:(&#39;Arg1 * &#39;Arg2 * &#39;Arg3 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromContinuations : callback:((&#39;T -&gt; unit) * (exn -&gt; unit) * (OperationCanceledException -&gt; unit) -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member Ignore : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br />static member OnCancel : interruption:(unit -&gt; unit) -&gt; Async&lt;IDisposable&gt;<br />static member Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;<br />static member RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T<br />static member Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;<br />static member Start : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions * ?cancellationToken:CancellationToken -&gt; Task&lt;&#39;T&gt;<br />static member StartChild : computation:Async&lt;&#39;T&gt; * ?millisecondsTimeout:int -&gt; Async&lt;Async&lt;&#39;T&gt;&gt;<br />static member StartChildAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions -&gt; Async&lt;Task&lt;&#39;T&gt;&gt;<br />static member StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartWithContinuations : computation:Async&lt;&#39;T&gt; * continuation:(&#39;T -&gt; unit) * exceptionContinuation:(exn -&gt; unit) * cancellationContinuation:(OperationCanceledException -&gt; unit) * ?cancellationToken:CancellationToken -&gt; unit<br />static member SwitchToContext : syncContext:SynchronizationContext -&gt; Async&lt;unit&gt;<br />static member SwitchToNewThread : unit -&gt; Async&lt;unit&gt;<br />static member SwitchToThreadPool : unit -&gt; Async&lt;unit&gt;<br />static member TryCancelled : computation:Async&lt;&#39;T&gt; * compensation:(OperationCanceledException -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member CancellationToken : Async&lt;CancellationToken&gt;<br />static member DefaultCancellationToken : CancellationToken<br /><br />Full name: Microsoft.FSharp.Control.Async<br /><br />--------------------<br />type Async&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Async&lt;_&gt;</div>
<div class="tip" id="fs46">abstract member Game.Update : unit -&gt; unit</div>
<div class="tip" id="fs47">abstract member Game.Draw : DrawingContext -&gt; unit</div>
<div class="tip" id="fs48">union case Choice.Choice1Of2: &#39;T1 -&gt; Choice&lt;&#39;T1,&#39;T2&gt;</div>
<div class="tip" id="fs49">union case Choice.Choice2Of2: &#39;T2 -&gt; Choice&lt;&#39;T1,&#39;T2&gt;</div>

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section >

<h1>Functional library design <br /><small>NCrafts.io, Paris, 21-22 May</small></h1>

<img src="images/fsformatting.png" style="width:150px;margin:60px" />

<p><strong>Tomas Petricek</strong>, fsharpWorks<br />
<a href="http://twitter.com/tomaspetricek">@tomaspetricek</a>
| <a href="http://tomasp.net">tomasp.net</a>
| <a href="http://fsharpworks.com">fsharpworks.com</a></p>

</section>

<section >

<section >

<img src="images/fsformatting.png" style="float:right;width:150px;margin-bottom:200px" />

<h2>Case study: F# Formatting</h2>

<p>I don't know <strong>the answer</strong>, but this<br />
worked nicely for one library!</p>

<br />

<ol>
<li>Formatting <em>F# snippets</em></li>
<li>Parsing <em>Markdown</em> documents</li>
<li><em>Literate</em> programming tools</li>
<li><em>Documentation</em> for .NET libraries</li>
</ol>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>From highlighting <em>F# snippets</em></h2>

<img src="images/fssnip-app.png" style="border:none;width:700px" />

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>And highlighting <em>F# snippets</em></h2>

<img src="images/fssnip-web.png" style="border:none;width:700px" />

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>To documenting <em>.NET libraries</em></h2>

<img src="images/scaffold.png" style="border:none;width:700px" />

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>The story of F# Formatting</h2>

<table>
<tbody>
<tr class="odd">
<td><p>F# Snippets web site</p></td>
<td><p><em>Sept 2010</em></p></td>
</tr>
<tr class="even">
<td><p>Markdown parser (TryJoinads)</p></td>
<td><p><em>Jan 2012</em></p></td>
</tr>
<tr class="odd">
<td><p>F# Data documentation</p></td>
<td><p><em>Jan 2013</em></p></td>
</tr>
<tr class="even">
<td><p>Deedle + ProjectScaffold</p></td>
<td><p><em>Oct 2013</em></p></td>
</tr>
<tr class="odd">
<td><p>FsLab Journal</p></td>
<td><p><em>Apr 2014</em></p></td>
</tr>
<tr class="even">
<td><p>FsReveal project</p></td>
<td><p><em>Jul 2014</em></p></td>
</tr>
</tbody>
</table>


</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>The story of F# Formatting</h2>

<ul>
<li><p><strong>Took a long time and changed</strong><br />
<em>Many good things start as dirty hacks!</em></p></li>
<li><p><strong>Does things we did not plan</strong><br />
<em>Composed and evolved from experiments</em></p></li>
<li><p><strong>Used in unexpected ways</strong><br />
<em>Even these slides! How cool is that?</em></p></li>
</ul>

</section>

</section>

<section >

<section >

<h1>Functional library design principles</h1>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<div class="large-icon-list">

<h2>Functional library design principles</h2>

<br />

<ul>
<li><i class="fa clr fa-magic"></i> Evolving design</li>
<li><i class="fa clr fa-cubes"></i> Composability</li>
<li><i class="fa clr fa-fax"></i> Avoid callbacks</li>
<li><i class="fa clr fa-tasks"></i> Layers of abstraction</li>
</ul>

</div>

</section>

</section>

<section >

<section >

<h1><i class="fa clr fa-magic"></i> Evolving design</h1>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h1><i class="fa clr2 fa-keyboard-o"></i> DEMO <i class="fa clr2 fa-keyboard-o"></i></h1>

<br />

<h2>From script to a library</h2>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<table><tr><td style="padding-right:40px">

<h3><i class="fa fa-pencil-square clr"></i> From script...</h3>

<ul>
<li><a href="http://fsprojects.github.io/Paket/">Paket</a> dependencies</li>
<li>Expose internals!</li>
<li>Copy and paste!</li>
</ul>

</td><td style="padding-left:40px">

<h3><i class="fa fa-book clr"></i> ...to library</h3>

<ul>
<li>Publish on NuGet</li>
<li>Documentation</li>
<li>Reusable API</li>
</ul>

</td></tr></table>

</section>

</section>

<section >

<section >

<h1><i class="fa clr fa-cubes"></i> Composability</h1>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h1><i class="fa clr2 fa-keyboard-o"></i> DEMO <i class="fa clr2 fa-keyboard-o"></i></h1>

<br />

<h2>Markdown with code formatting</h2>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Markdown with code formatting</h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="f">collectSnips</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">par</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">seq</span> {
  <span class="k">match</span> <span onmouseout="hideTip(event, 'fs2', 4)" onmouseover="showTip(event, 'fs2', 4)" class="i">par</span> <span class="k">with</span>
  | <span class="i">CodeBlock</span>(<span class="i">code</span>, <span class="s">&quot;fsharp&quot;</span>, _) <span class="k">-&gt;</span>
      <span class="c">// Extract F# code block for formatting!</span>
      <span class="k">yield</span> <span class="i">code</span>
  | <span class="i">Matching</span><span class="o">.</span><span class="i">ParagraphNested</span>(_, <span class="i">pars</span>) <span class="k">-&gt;</span>
      <span class="k">for</span> <span class="i">p</span> <span class="k">in</span> <span class="i">pars</span> <span class="k">do</span>
        <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs1', 5)" onmouseover="showTip(event, 'fs1', 5)" class="i">collectSnips</span> <span class="i">p</span>
  | _ <span class="k">-&gt;</span> () }

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="i">codes</span> <span class="o">=</span> <span class="i">doc</span><span class="o">.</span><span class="i">Paragraphs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="f">collect</span> <span onmouseout="hideTip(event, 'fs1', 9)" onmouseover="showTip(event, 'fs1', 9)" class="f">collectSnips</span>
</pre>
</td>
</tr>
</table>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Markdown with code formatting</h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="f">replaceSnips</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">lookup</span> <span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="i">par</span> <span class="o">=</span>
  <span class="k">match</span> <span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="i">par</span> <span class="k">with</span>
  | <span class="i">CodeBlock</span>(<span class="i">code</span>, <span class="s">&quot;fsharp&quot;</span>, _) <span class="k">-&gt;</span>
      <span class="c">// Replace F# snippet with formatted HTML</span>
      <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="i">Literal</span>(<span onmouseout="hideTip(event, 'fs8', 15)" onmouseover="showTip(event, 'fs8', 15)" class="i">lookup</span><span class="o">.</span>[<span class="i">code</span>])
  | <span class="i">Matching</span><span class="o">.</span><span class="i">ParagraphNested</span>(<span class="i">pn</span>, <span class="i">nested</span>) <span class="k">-&gt;</span>
      <span class="k">let</span> <span class="i">pars</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs11', 16)" onmouseover="showTip(event, 'fs11', 16)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="i">map</span> (<span onmouseout="hideTip(event, 'fs7', 18)" onmouseover="showTip(event, 'fs7', 18)" class="i">replaceSnips</span> <span onmouseout="hideTip(event, 'fs8', 19)" onmouseover="showTip(event, 'fs8', 19)" class="i">lookup</span>) <span class="i">nested</span>
      <span class="i">Matching</span><span class="o">.</span><span class="i">ParagraphNested</span>(<span class="i">pn</span>, <span class="i">pars</span>)
  | <span class="i">other</span> <span class="k">-&gt;</span> <span class="i">other</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 20)" onmouseover="showTip(event, 'fs13', 20)" class="i">newPars</span> <span class="o">=</span> <span class="i">doc</span><span class="o">.</span><span class="i">Paragraphs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs11', 21)" onmouseover="showTip(event, 'fs11', 21)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 22)" onmouseover="showTip(event, 'fs12', 22)" class="f">map</span> <span onmouseout="hideTip(event, 'fs7', 23)" onmouseover="showTip(event, 'fs7', 23)" class="f">replaceSnips</span>
</pre>
</td>
</tr>
</table>

</section>

</section>

<section >

<section >

<h1><i class="fa clr fa-fax"></i> Avoid callbacks</h1>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<table><tr><td style="padding-right:40px;text-align:center;">

<h3>Libraries</h3>

<p>Call methods or functions</p>

<img src="images/diag-lib.png" style="background:none;width:300px;border:none;" />
</td><td style="padding-left:40px;text-align:center;" class="fragment">

<h3>Frameworks</h3>

<p>Implement an interface</p>

<img src="images/diag-fwk.png" style="background:none;width:300px;border:none;" />
</td></tr></table>
<div class="fragment">

<p>No <em>formal</em> definitions, but callbacks are indicators!</p>

</div>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Avoid callbacks and frameworks</h2>

<p>Frameworks do not compose <em>nicely</em>!</p>

<img src="images/diag-fwk-compose.png" style="background:none;width:700px;border:none;" />

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Avoid callbacks and frameworks</h2>

<p>Composing libraries is <em>easy</em>!</p>

<img src="images/diag-lib-compose.png" style="background:none;width:700px;border:none;" />

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h1><i class="fa clr2 fa-hand-o-right"></i> SAMPLE <i class="fa clr2 fa-hand-o-left"></i></h1>

<br />

<h2>Framework vs. library style</h2>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>In the F# Formatting context</h2>

<p>We want to customize the document:</p>

<ul>
<li>Parse Markdown document</li>
<li><em>Split multi-language snippets</em></li>
<li>Format F# &amp; other snippets</li>
<li><em>Generate HTML with tabs</em></li>
<li>Produce final HTML document</li>
</ul>

<div class="fragment">

<p>Used in <a href="http://quantalea.com/static/app/tutorial/quick_start/quick_start_example.html">Alea GPU tutorial</a>
by QuantAlea.</p>

</div>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Framework approach</h2>

<p>Pass interface implementation to <code>Literate.Process</code>:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs14', 24)" onmouseover="showTip(event, 'fs14', 24)" class="t">IDocProcessor</span> <span class="o">=</span>
  <span class="k">abstract</span> <span onmouseout="hideTip(event, 'fs15', 25)" onmouseover="showTip(event, 'fs15', 25)" class="f">OnParseDoc</span> <span class="o">:</span> <span class="i">Document</span> <span class="k">-&gt;</span> <span class="i">Document</span>
  <span class="k">abstract</span> <span onmouseout="hideTip(event, 'fs16', 26)" onmouseover="showTip(event, 'fs16', 26)" class="f">OnFormatDoc</span> <span class="o">:</span> <span class="i">Document</span> <span class="k">-&gt;</span> <span class="i">Document</span>
  <span class="k">abstract</span> <span onmouseout="hideTip(event, 'fs17', 27)" onmouseover="showTip(event, 'fs17', 27)" class="f">OnParseSnippet</span> <span class="o">:</span> <span class="i">Node</span> <span class="k">-&gt;</span> <span class="i">Node</span>
  <span class="k">abstract</span> <span onmouseout="hideTip(event, 'fs18', 28)" onmouseover="showTip(event, 'fs18', 28)" class="f">OnFormatSnippet</span> <span class="o">:</span> <span class="i">Node</span> <span class="k">-&gt;</span> <span class="i">Node</span>
  <span class="c">// Lots of methods we can override!</span>
</pre>
</td>
</tr>
</table>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Framework approach</h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs19', 29)" onmouseover="showTip(event, 'fs19', 29)" class="t">MultiLangHandler</span>() <span class="o">=</span>
  <span class="k">inherit</span> <span class="i">DocProcessor</span>()
  <span class="k">let</span> <span class="k">mutable</span> <span class="i">snippets</span> <span class="o">=</span> []
  <span class="k">let</span> <span class="k">mutable</span> <span class="i">transformed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs20', 30)" onmouseover="showTip(event, 'fs20', 30)" class="i">None</span>
  <span class="c">// Collect all parsed snippets for later</span>
  <span class="k">override</span> <span class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 31)" onmouseover="showTip(event, 'fs21', 31)" class="f">OnParseSnippet</span>(<span class="i">snip</span>) <span class="o">=</span>
    <span class="i">snippets</span> <span class="o">&lt;-</span> <span class="i">snip</span><span class="o">::</span><span class="i">snippets</span>
  <span class="c">// Transform when we have all &amp; format</span>
  <span class="k">override</span> <span class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 32)" onmouseover="showTip(event, 'fs22', 32)" class="f">OnFormatSnippet</span>(<span class="i">snip</span>) <span class="o">=</span>
    <span class="k">if</span> <span class="i">transformed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs20', 33)" onmouseover="showTip(event, 'fs20', 33)" class="i">None</span> <span class="k">then</span>
      <span class="i">transformed</span> <span class="o">&lt;-</span> <span class="i">transformAll</span> <span class="i">snippets</span>
    <span class="i">lookup</span> <span class="i">transformed</span> <span class="i">snip</span>
</pre>
</td>
</tr>
</table>

<div class="fragment">

<ul>
<li>Frameworks lead to <em>uninitalized states</em></li>
<li>Frameworks lead to <em>mutation</em></li>
<li>Frameworks lead to <em>inheritance complexity</em></li>
</ul>

</div>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Library approach</h2>

<div class="fragment">

<p>Provide more <em>fine-grained</em> functions:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 34)" onmouseover="showTip(event, 'fs23', 34)" class="i">doc</span> <span class="o">=</span> <span class="i">Literate</span><span class="o">.</span><span class="i">ParseScriptString</span>(<span class="i">input</span>) <span class="c">// Library</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 35)" onmouseover="showTip(event, 'fs24', 35)" class="i">snips</span> <span class="o">=</span> <span class="i">collectCodeSnippets</span> <span onmouseout="hideTip(event, 'fs23', 36)" onmouseover="showTip(event, 'fs23', 36)" class="i">doc</span>         <span class="c">// us</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 37)" onmouseover="showTip(event, 'fs24', 37)" class="i">snips</span> <span class="o">=</span> <span class="i">transformSnippets</span> <span onmouseout="hideTip(event, 'fs24', 38)" onmouseover="showTip(event, 'fs24', 38)" class="i">snips</span>         <span class="c">// us</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 39)" onmouseover="showTip(event, 'fs23', 39)" class="i">doc</span> <span class="o">=</span> <span class="i">Literate</span><span class="o">.</span><span class="i">FormatLiterateNodes</span>(<span onmouseout="hideTip(event, 'fs23', 40)" onmouseover="showTip(event, 'fs23', 40)" class="i">doc</span>) <span class="c">// Library</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 41)" onmouseover="showTip(event, 'fs23', 41)" class="i">doc</span> <span class="o">=</span> <span class="i">replaceSnippets</span> <span onmouseout="hideTip(event, 'fs24', 42)" onmouseover="showTip(event, 'fs24', 42)" class="i">snips</span> <span onmouseout="hideTip(event, 'fs23', 43)" onmouseover="showTip(event, 'fs23', 43)" class="i">doc</span>         <span class="c">// us</span>
<span class="i">Literate</span><span class="o">.</span><span class="i">WriteHtml</span>(<span onmouseout="hideTip(event, 'fs23', 44)" onmouseover="showTip(event, 'fs23', 44)" class="i">doc</span>)                     <span class="c">// Library</span>
</pre>
</td>
</tr>
</table>

</div><div class="fragment">

<ul>
<li>We control the <em>control flow</em></li>
<li>We control <em>our additional state</em></li>
<li>Still call library-provided steps!</li>
</ul>

</div>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h1><i class="fa clr2 fa-hand-o-right"></i> WALKTHROUGH <i class="fa clr2 fa-hand-o-left"></i></h1>

<br />

<h2>Inverting the flow in games</h2>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Class in a game framework</h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs25', 45)" onmouseover="showTip(event, 'fs25', 45)" class="t">Game</span> <span class="o">=</span>
  <span class="k">abstract</span> <span onmouseout="hideTip(event, 'fs26', 46)" onmouseover="showTip(event, 'fs26', 46)" class="f">Initialize</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs27', 47)" onmouseover="showTip(event, 'fs27', 47)" class="t">unit</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="t">unit</span>
  <span class="k">abstract</span> <span onmouseout="hideTip(event, 'fs28', 49)" onmouseover="showTip(event, 'fs28', 49)" class="f">Draw</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs29', 50)" onmouseover="showTip(event, 'fs29', 50)" class="t">DrawingContext</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 51)" onmouseover="showTip(event, 'fs27', 51)" class="t">unit</span>
  <span class="k">abstract</span> <span onmouseout="hideTip(event, 'fs30', 52)" onmouseover="showTip(event, 'fs30', 52)" class="f">Update</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs27', 53)" onmouseover="showTip(event, 'fs27', 53)" class="t">unit</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 54)" onmouseover="showTip(event, 'fs27', 54)" class="t">unit</span>
</pre>
</td>
</tr>
</table>

<div class="fragment">
<br />

<h3>User just implements an abstract class!</h3>

<ul>
<li>Web frameworks love this!</li>
<li>But what is the contract?</li>
</ul>

</div>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Using a game framework</h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs31', 55)" onmouseover="showTip(event, 'fs31', 55)" class="t">MyGame</span>() <span class="o">=</span>
  <span class="k">inherit</span> <span onmouseout="hideTip(event, 'fs25', 56)" onmouseover="showTip(event, 'fs25', 56)" class="t">Game</span>()
  <span class="k">let</span> <span class="k">mutable</span> <span class="i">x</span> <span class="o">=</span> <span class="n">0</span>
  <span class="k">let</span> <span class="k">mutable</span> <span class="i">mario</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs20', 57)" onmouseover="showTip(event, 'fs20', 57)" class="i">None</span>

  <span class="k">override</span> <span class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 58)" onmouseover="showTip(event, 'fs32', 58)" class="f">Initialize</span>() <span class="o">=</span>
    <span class="i">mario</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs33', 59)" onmouseover="showTip(event, 'fs33', 59)" class="i">Some</span>(<span class="i">Image</span><span class="o">.</span><span class="i">Load</span>(<span class="s">&quot;mario.png&quot;</span>))
  <span class="k">override</span> <span class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 60)" onmouseover="showTip(event, 'fs34', 60)" class="f">Update</span>() <span class="o">=</span>
    <span class="i">x</span> <span class="o">&lt;-</span> <span class="i">x</span> <span class="o">+</span> <span class="n">1</span>
  <span class="k">override</span> <span class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 61)" onmouseover="showTip(event, 'fs35', 61)" class="f">Draw</span>(<span class="i">ctx</span>) <span class="o">=</span>
    <span class="i">mario</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs36', 62)" onmouseover="showTip(event, 'fs36', 62)" class="i">Option</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 63)" onmouseover="showTip(event, 'fs37', 63)" class="i">iter</span> (<span class="k">fun</span> <span class="i">mario</span> <span class="k">-&gt;</span>
      <span class="i">ctx</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 64)" onmouseover="showTip(event, 'fs35', 64)" class="i">Draw</span>(<span class="i">x</span>, <span class="n">0</span>, <span class="i">mario</span>))

<span onmouseout="hideTip(event, 'fs25', 65)" onmouseover="showTip(event, 'fs25', 65)" class="i">Game</span><span class="o">.</span><span class="i">Start</span>(<span class="k">new</span> <span onmouseout="hideTip(event, 'fs31', 66)" onmouseover="showTip(event, 'fs31', 66)" class="i">MyGame</span>())
</pre>
</td>
</tr>
</table>

<div class="fragment">

<ul>
<li>Frameworks often need <em>mutation</em></li>
<li>Framewokrs often need <em>uninitalized state</em></li>
</ul>

</div>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Designing a game <em>library</em></h2>

<p>How to put the user in control? <em>Use events!</em></p>

<div class="fragment">
<br />

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs25', 67)" onmouseover="showTip(event, 'fs25', 67)" class="i">Game</span> <span class="o">=</span>
  <span class="k">member</span> <span class="i">Update</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs38', 68)" onmouseover="showTip(event, 'fs38', 68)" class="i">IEvent</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs27', 69)" onmouseover="showTip(event, 'fs27', 69)" class="i">unit</span><span class="o">&gt;</span>
  <span class="k">member</span> <span onmouseout="hideTip(event, 'fs35', 70)" onmouseover="showTip(event, 'fs35', 70)" class="i">Draw</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs38', 71)" onmouseover="showTip(event, 'fs38', 71)" class="i">IEvent</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs29', 72)" onmouseover="showTip(event, 'fs29', 72)" class="i">DrawingContext</span><span class="o">&gt;</span>
  <span class="k">member</span> <span class="i">IsRunning</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs39', 73)" onmouseover="showTip(event, 'fs39', 73)" class="i">bool</span>
</pre>
</td>
</tr>
</table>

</div>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Designing a game <em>library</em></h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Initialize game and resources</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 74)" onmouseover="showTip(event, 'fs40', 74)" class="i">game</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs25', 75)" onmouseover="showTip(event, 'fs25', 75)" class="t">Game</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs41', 76)" onmouseover="showTip(event, 'fs41', 76)" class="i">mario</span> <span class="o">=</span> <span class="i">Image</span><span class="o">.</span><span class="i">Load</span>(<span class="s">&quot;mario.png&quot;</span>)
</pre>
</td>
</tr>
</table>

<div style="height:0px"></div>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Recursive loop that runs until the end of the game</span>
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs42', 77)" onmouseover="showTip(event, 'fs42', 77)" class="f">loop</span> <span onmouseout="hideTip(event, 'fs43', 78)" onmouseover="showTip(event, 'fs43', 78)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs44', 79)" onmouseover="showTip(event, 'fs44', 79)" class="i">async</span> {
  <span class="k">if</span> <span onmouseout="hideTip(event, 'fs40', 80)" onmouseover="showTip(event, 'fs40', 80)" class="i">game</span><span class="o">.</span><span class="i">IsRunning</span> <span class="k">then</span>
    <span class="k">let!</span> <span class="i">evt</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs45', 81)" onmouseover="showTip(event, 'fs45', 81)" class="i">Async</span><span class="o">.</span><span class="i">AwaitObservable</span>
      (<span onmouseout="hideTip(event, 'fs40', 82)" onmouseover="showTip(event, 'fs40', 82)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 83)" onmouseover="showTip(event, 'fs46', 83)" class="i">Update</span>, <span onmouseout="hideTip(event, 'fs40', 84)" onmouseover="showTip(event, 'fs40', 84)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 85)" onmouseover="showTip(event, 'fs47', 85)" class="i">Draw</span>)
    <span class="k">match</span> <span class="i">evt</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs48', 86)" onmouseover="showTip(event, 'fs48', 86)" class="i">Choice1Of2</span>() <span class="k">-&gt;</span> <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs42', 87)" onmouseover="showTip(event, 'fs42', 87)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs43', 88)" onmouseover="showTip(event, 'fs43', 88)" class="i">x</span> <span class="o">+</span> <span class="n">1</span>)
    | <span onmouseout="hideTip(event, 'fs49', 89)" onmouseover="showTip(event, 'fs49', 89)" class="i">Choice2Of2</span>(<span class="i">ctx</span>) <span class="k">-&gt;</span>
        <span class="i">ctx</span><span class="o">.</span><span class="i">Draw</span>(<span onmouseout="hideTip(event, 'fs43', 90)" onmouseover="showTip(event, 'fs43', 90)" class="i">x</span>, <span class="n">0</span>, <span onmouseout="hideTip(event, 'fs41', 91)" onmouseover="showTip(event, 'fs41', 91)" class="i">mario</span>)
        <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs42', 92)" onmouseover="showTip(event, 'fs42', 92)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs43', 93)" onmouseover="showTip(event, 'fs43', 93)" class="i">x</span> }
</pre>
</td>
</tr>
</table>

<div style="height:0px"></div>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs42', 94)" onmouseover="showTip(event, 'fs42', 94)" class="f">loop</span> <span class="n">0</span>  <span class="c">// Start with x=0</span>
</pre>
</td>
</tr>
</table>

</section>

</section>

<section >

<section >

<h1><i class="fa clr fa-tasks"></i> Layers of abstraction</h1>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Layers of abstraction</h2>

<img src="images/diag-layers.png" style="background:none;width:400px;margin:20px;border:none;" />

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Case study: F# lists</h2>

<table><tr><td style="padding-right:30px">

<h3>High-level</h3>

<ul>
<li>Higher-order funcs</li>
<li><code>map</code>, <code>filter</code> etc</li>
<li>85% of cases</li>
</ul>

</td><td style="padding-left:30px">

<h3>Low-level</h3>

<ul>
<li>Recursive funcs</li>
<li><code>x::xs</code> and <code>[]</code></li>
<li>Remaining 15%</li>
</ul>

</td></tr></table>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Case study: Functional 3D</h2>

<a href="http://www.fun3d.net">
<img src="images/fun3d.png" style="background:none;width:500px;border:none;" />
</a>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h1><i class="fa clr2 fa-keyboard-o"></i> DEMO <i class="fa clr2 fa-keyboard-o"></i></h1>

<br />

<h2>FsReveal and F# Formatting</h2>

</section>

</section>

<section >

<section >

<h1>Summary</h1>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Libraries and frameworks</h2>

<table><tr><td style="padding-right:30px">

<h3>Libraries <i class="fa fa-thumbs-o-up" style="color:#4AEF4A"></i></h3>

<ul>
<li>Use multiple libs</li>
<li>Clear control flow</li>
<li>Layers of abstraction</li>
</ul>

</td><td style="padding-left:30px">

<h3>Frameworks  <i class="fa fa-thumbs-o-down" style="color:#FF4255"></i></h3>

<ul>
<li>One framework only</li>
<li>Many entry points</li>
<li>One way of doing things</li>
</ul>

</td></tr></table>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h2>Functional library design principles</h2>

<p><i class="fa clr fa-magic"></i> <em>Evolving design</em><br />
Encourage early experiments</p>

<p><i class="fa clr fa-cubes"></i> <em>Composability</em><br />
Allow unexpected uses</p>

<p><i class="fa clr fa-fax"></i> <em>Avoid callbacks</em><br />
Let the caller control things</p>

<p><i class="fa clr fa-tasks"></i> <em>Layers of abstraction</em><br />
Make 85% tasks easy, 99% possible</p>

</section>

<section author="Tomas Petricek" description="What is the difference between frameworks and libraries
and why (and how) you should design libraries &amp; avoid frameworks." theme="night" title="Functional library design" transition="none">

<h1>Thank you!</h1>

<br />

<table><tr><td style="vertical-align:middle;padding-right:30px;">
<img src="images/ad-fworks.png" style="width:250px;background:transparent;border:none;" />
</td><td style="padding-left:30px;">
<img src="images/ad-qsh.png" style="width:190px;background:transparent;border:none;" />
</td></tr></table>

<br />

<p><strong>Tomas Petricek</strong>, fsharpWorks</p>

<p>See <a href="http://functional-programming.net/">functional-programming.net</a> for books &amp; trainings!<br />
<a href="http://twitter.com/tomaspetricek">@tomaspetricek</a>
| <a href="http://tomasp.net">tomasp.net</a>
| <a href="http://fsharpworks.com">fsharpworks.com</a></p>

</section>

</section>



        </div>
    </div>
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script>

        // Full list of configuration options available here:
        // https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            controls: true,
            progress: true,
            history: true,
            center: true,

            transition: 'none', // default/cube/page/concave/zoom/linear/fade/none

            // Parallax scrolling
            // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
            // parallaxBackgroundSize: '2100px 900px',

            // Optional libraries used to extend on reveal.js
            dependencies: [
                { src: 'lib/js/classList.js', condition: function () { return !document.body.classList; } },
                { src: 'plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
                { src: 'plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
                { src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
                { src: 'plugin/zoom-js/zoom.js', async: true, condition: function () { return !!document.body.classList; } },
                { src: 'plugin/notes/notes.js', async: true, condition: function () { return !!document.body.classList; } }
            ]
        });

    </script>
</body>
</html>
